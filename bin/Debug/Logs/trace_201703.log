2017-03-14 09:06:39,233 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 593  - Open connection to SQL Server  
2017-03-14 09:06:39,358 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 718  - Open connection to SQL Server  
2017-03-14 09:06:39,358 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 718  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null and is_default = 0;  
2017-03-14 09:06:39,374 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 734  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:06:39,390 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 750  - Execute sql: SELECT DISTINCT REVERSE(SUBSTRING(REVERSE(path), CHARINDEX('\', REVERSE(path)), 256)) as [DirTrace] FROM sys.traces WHERE max_files is not null and is_default = 0  
2017-03-14 09:06:39,390 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 750  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:06:50,876 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 12236  - Open connection to SQL Server  
2017-03-14 09:06:50,876 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 12236  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null and is_default = 0;  
2017-03-14 09:06:50,876 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 12236  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:06:50,876 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 12236  - Execute sql: SELECT DISTINCT REVERSE(SUBSTRING(REVERSE(path), CHARINDEX('\', REVERSE(path)), 256)) as [DirTrace] FROM sys.traces WHERE max_files is not null and is_default = 0  
2017-03-14 09:06:59,080 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 20440  - Open connection to SQL Server  
2017-03-14 09:06:59,080 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 20440  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null and is_default = 0;  
2017-03-14 09:06:59,080 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 20440  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:06:59,080 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 20440  - Execute sql: SELECT DISTINCT REVERSE(SUBSTRING(REVERSE(path), CHARINDEX('\', REVERSE(path)), 256)) as [DirTrace] FROM sys.traces WHERE max_files is not null and is_default = 0  
2017-03-14 09:06:59,736 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 21096  - Open connection to SQL Server  
2017-03-14 09:06:59,752 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 21112  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null and is_default = 0;  
2017-03-14 09:06:59,752 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 21112  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:06:59,752 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 21112  - Execute sql: SELECT DISTINCT REVERSE(SUBSTRING(REVERSE(path), CHARINDEX('\', REVERSE(path)), 256)) as [DirTrace] FROM sys.traces WHERE max_files is not null and is_default = 0  
2017-03-14 09:07:11,893 ERROR FISSOFT\NgocLD Profiler.Form1 lbReport_DoubleClick 33253  - Exception: Object reference not set to an instance of an object.  
2017-03-14 09:07:17,624 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 38984  - Open connection to SQL Server  
2017-03-14 09:07:17,624 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 38984  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null and is_default = 0;  
2017-03-14 09:07:17,624 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 38984  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:07:17,624 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 38984  - Execute sql: SELECT DISTINCT REVERSE(SUBSTRING(REVERSE(path), CHARINDEX('\', REVERSE(path)), 256)) as [DirTrace] FROM sys.traces WHERE max_files is not null and is_default = 0  
2017-03-14 09:07:18,827 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess ExecuteSqlNoTran 40187  - Execute sql: declare @rc INT declare @TraceID INT declare @maxfilesize BIGINT = 300 declare @countfile INT = 30 declare @PathfileLog NVARCHAR(256) = N'E:\Temp\LinhNV\traceihrp' exec @rc = sp_trace_create @TraceID output, @options = 2, @tracefile = @PathfileLog, @maxfilesize = @maxfilesize, @stoptime = NULL, @filecount = @countfile declare @on BIT = 1 exec sp_trace_setevent @TraceID, 12, 1, @on exec sp_trace_setevent @TraceID, 12, 9, @on exec sp_trace_setevent @TraceID, 12, 11, @on exec sp_trace_setevent @TraceID, 12, 6, @on exec sp_trace_setevent @TraceID, 12, 8, @on exec sp_trace_setevent @TraceID, 12, 10, @on exec sp_trace_setevent @TraceID, 12, 12, @on exec sp_trace_setevent @TraceID, 12, 13, @on exec sp_trace_setevent @TraceID, 12, 14, @on exec sp_trace_setevent @TraceID, 12, 15, @on exec sp_trace_setevent @TraceID, 12, 16, @on exec sp_trace_setevent @TraceID, 12, 17, @on exec sp_trace_setevent @TraceID, 12, 18, @on exec sp_trace_setevent @TraceID, 12, 31, @on exec sp_trace_setevent @TraceID, 12, 35, @on exec sp_trace_setevent @TraceID, 12, 48, @on exec sp_trace_setevent @TraceID, 12, 60, @on exec sp_trace_setevent @TraceID, 81, 12, @on exec sp_trace_setevent @TraceID, 81, 14, @on exec sp_trace_setevent @TraceID, 81, 21, @on exec sp_trace_setevent @TraceID, 81, 25, @on exec sp_trace_setevent @TraceID, 81, 26, @on exec sp_trace_setevent @TraceID, 81, 51, @on exec sp_trace_setevent @TraceID, 81, 60, @on exec sp_trace_setevent @TraceID, 81, 64, @on exec sp_trace_setevent @TraceID, 92, 3, @on exec sp_trace_setevent @TraceID, 92, 11, @on exec sp_trace_setevent @TraceID, 92, 8, @on exec sp_trace_setevent @TraceID, 92, 10, @on exec sp_trace_setevent @TraceID, 92, 12, @on exec sp_trace_setevent @TraceID, 92, 13, @on exec sp_trace_setevent @TraceID, 92, 14, @on exec sp_trace_setevent @TraceID, 92, 15, @on exec sp_trace_setevent @TraceID, 92, 25, @on exec sp_trace_setevent @TraceID, 92, 26, @on exec sp_trace_setevent @TraceID, 92, 35, @on exec sp_trace_setevent @TraceID, 92, 51, @on exec sp_trace_setevent @TraceID, 92, 60, @on exec sp_trace_setevent @TraceID, 92, 64, @on exec sp_trace_setevent @TraceID, 94, 3, @on exec sp_trace_setevent @TraceID, 94, 11, @on exec sp_trace_setevent @TraceID, 94, 8, @on exec sp_trace_setevent @TraceID, 94, 10, @on exec sp_trace_setevent @TraceID, 94, 12, @on exec sp_trace_setevent @TraceID, 94, 13, @on exec sp_trace_setevent @TraceID, 94, 14, @on exec sp_trace_setevent @TraceID, 94, 15, @on exec sp_trace_setevent @TraceID, 94, 25, @on exec sp_trace_setevent @TraceID, 94, 26, @on exec sp_trace_setevent @TraceID, 94, 35, @on exec sp_trace_setevent @TraceID, 94, 51, @on exec sp_trace_setevent @TraceID, 94, 60, @on exec sp_trace_setevent @TraceID, 94, 64, @on exec sp_trace_setevent @TraceID, 93, 3, @on exec sp_trace_setevent @TraceID, 93, 11, @on exec sp_trace_setevent @TraceID, 93, 8, @on exec sp_trace_setevent @TraceID, 93, 10, @on exec sp_trace_setevent @TraceID, 93, 12, @on exec sp_trace_setevent @TraceID, 93, 13, @on exec sp_trace_setevent @TraceID, 93, 14, @on exec sp_trace_setevent @TraceID, 93, 15, @on exec sp_trace_setevent @TraceID, 93, 25, @on exec sp_trace_setevent @TraceID, 93, 26, @on exec sp_trace_setevent @TraceID, 93, 35, @on exec sp_trace_setevent @TraceID, 93, 51, @on exec sp_trace_setevent @TraceID, 93, 60, @on exec sp_trace_setevent @TraceID, 93, 64, @on exec sp_trace_setevent @TraceID, 95, 3, @on exec sp_trace_setevent @TraceID, 95, 11, @on exec sp_trace_setevent @TraceID, 95, 8, @on exec sp_trace_setevent @TraceID, 95, 10, @on exec sp_trace_setevent @TraceID, 95, 12, @on exec sp_trace_setevent @TraceID, 95, 13, @on exec sp_trace_setevent @TraceID, 95, 14, @on exec sp_trace_setevent @TraceID, 95, 15, @on exec sp_trace_setevent @TraceID, 95, 25, @on exec sp_trace_setevent @TraceID, 95, 26, @on exec sp_trace_setevent @TraceID, 95, 35, @on exec sp_trace_setevent @TraceID, 95, 51, @on exec sp_trace_setevent @TraceID, 95, 60, @on exec sp_trace_setevent @TraceID, 95, 64, @on exec sp_trace_setevent @TraceID, 25, 1, @on exec sp_trace_setevent @TraceID, 25, 9, @on exec sp_trace_setevent @TraceID, 25, 10, @on exec sp_trace_setevent @TraceID, 25, 3, @on exec sp_trace_setevent @TraceID, 25, 8, @on exec sp_trace_setevent @TraceID, 25, 11, @on exec sp_trace_setevent @TraceID, 25, 12, @on exec sp_trace_setevent @TraceID, 25, 13, @on exec sp_trace_setevent @TraceID, 25, 14, @on exec sp_trace_setevent @TraceID, 25, 15, @on exec sp_trace_setevent @TraceID, 25, 26, @on exec sp_trace_setevent @TraceID, 25, 32, @on exec sp_trace_setevent @TraceID, 25, 35, @on exec sp_trace_setevent @TraceID, 25, 57, @on exec sp_trace_setevent @TraceID, 25, 60, @on exec sp_trace_setevent @TraceID, 25, 64, @on exec sp_trace_setevent @TraceID, 10, 1, @on exec sp_trace_setevent @TraceID, 10, 9, @on exec sp_trace_setevent @TraceID, 10, 2, @on exec sp_trace_setevent @TraceID, 10, 10, @on exec sp_trace_setevent @TraceID, 10, 3, @on exec sp_trace_setevent @TraceID, 10, 6, @on exec sp_trace_setevent @TraceID, 10, 8, @on exec sp_trace_setevent @TraceID, 10, 11, @on exec sp_trace_setevent @TraceID, 10, 12, @on exec sp_trace_setevent @TraceID, 10, 13, @on exec sp_trace_setevent @TraceID, 10, 14, @on exec sp_trace_setevent @TraceID, 10, 15, @on exec sp_trace_setevent @TraceID, 10, 16, @on exec sp_trace_setevent @TraceID, 10, 17, @on exec sp_trace_setevent @TraceID, 10, 18, @on exec sp_trace_setevent @TraceID, 10, 26, @on exec sp_trace_setevent @TraceID, 10, 31, @on exec sp_trace_setevent @TraceID, 10, 35, @on exec sp_trace_setevent @TraceID, 10, 48, @on exec sp_trace_setfilter @TraceID, 10, 0, 7, N'Microsoft SQL Server Management Studio - Transact-SQL IntelliSense' exec sp_trace_setfilter @TraceID, 10, 0, 7, N'SQL Trace Log iHRP' exec sp_trace_setfilter @TraceID, 1, 0, 7, N'exec sp_reset_connection' exec sp_trace_setstatus @TraceID, 1   
2017-03-14 09:07:18,827 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 40187  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null and is_default = 0;  
2017-03-14 09:07:21,202 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 42562  - Open connection to SQL Server  
2017-03-14 09:07:21,296 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 42656  - Open connection to SQL Server  
2017-03-14 09:07:21,296 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 42656  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null and is_default = 0;  
2017-03-14 09:07:21,312 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 42672  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:07:21,312 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 42672  - Execute sql: SELECT DISTINCT REVERSE(SUBSTRING(REVERSE(path), CHARINDEX('\', REVERSE(path)), 256)) as [DirTrace] FROM sys.traces WHERE max_files is not null and is_default = 0  
2017-03-14 09:07:21,312 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 42672  - Execute sql: EXEC master.sys.xp_dirtree 'E:\Temp\LinhNV\',1,1  
2017-03-14 09:07:25,407 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 46766  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp.trc', 1) a  
2017-03-14 09:07:39,861 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 61221  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:07:39,877 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 61237  - Execute sql: SELECT top 100 a.TextData, a.HostName, a.ApplicationName, a.LoginName, a.ServerName, a.EventClass, a.Error, a.DatabaseName, a.RowCounts, a.Duration / 1000000 as [Duration (s)], a.StartTime, a.EndTime, a.Reads, a.Writes, a.CPU FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp.trc', 3) a WHERE a.EventClass in (10, 12) order by a.Duration desc  
2017-03-14 09:09:25,472 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 166832  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:09:26,722 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 168082  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:09:26,722 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 168082  - Execute sql: SELECT a.DatabaseName, COUNT(*) AS RequestHit, SUM(duration) / 1000000  AS [Duration (s)], SUM(CPU) AS CPU, SUM(Reads) AS Reads, SUM(Writes) AS Writes, SUM(Error) as ErrorHits FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp.trc', 3) a WHERE a.EventClass in (10, 12) and a.DatabaseName is not null GROUP BY a.DatabaseName order by Reads desc  
2017-03-14 09:09:50,356 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 191716  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:09:52,591 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 193951  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:09:52,591 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 193951  - Execute sql: SELECT a.StartTime AS [Day], COUNT(*) AS RequestHit, SUM(duration) / 1000000  AS [Duration (s)], SUM(CPU) AS CPU, SUM(Reads) AS Reads, SUM(Writes) AS Writes, SUM(Error) as ErrorHits FROM (SELECT CONVERT(DATE, StartTime) AS StartTime, CPU, Duration, Reads, Writes, Error FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp.trc', 3) WHERE EventClass in (10, 12)) a WHERE StartTime is not null GROUP BY StartTime ORDER BY StartTime  
2017-03-14 09:10:37,859 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 239218  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:10:38,515 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 239875  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:10:38,515 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 239875  - Execute sql: SELECT a.StartTime AS [HoursTime], COUNT(*) AS RequestHit, SUM(duration) / 1000000 AS [Duration (s)], SUM(CPU) AS CPU, SUM(Reads) AS Reads, SUM(Writes) AS Writes, SUM(Error) as ErrorHits FROM (SELECT DATEADD(Hour, DATEDIFF(Hour, 0, StartTime), 0) AS StartTime, cpu, Duration, Reads, Writes, Error FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp.trc', 3) WHERE EventClass in (10, 12)) a WHERE StartTime is not null GROUP BY StartTime ORDER BY StartTime  
2017-03-14 09:11:14,709 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 276069  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:11:16,522 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 277882  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:11:17,162 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 278522  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:11:17,162 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 278522  - Execute sql: SELECT a.StartTime, case when a.EventSubClass = '1' then 'Increment Memory' else convert(varchar, a.EventSubClass) end as [Type], a.ServerName, a.IsSystem FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp.trc', 3) a WHERE a.EventClass = 81 order by a.StartTime desc  
2017-03-14 09:11:22,077 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 283436  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:11:22,078 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 283437  - Execute sql: SELECT a.TextData, a.DatabaseID, a.DatabaseName, a.HostName, a.ApplicationName, a.LoginName, a.SPID, a.Duration / 1000000 as [Duration (s)], a.StartTime, a.EndTime, a.ServerName, a.EventClass, a.Mode, a.[Type], a.IsSystem FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp.trc', 3) a  WHERE a.EventClass IN (25) order by isnull(a.EndTime, a.StartTime) desc  
2017-03-14 09:11:52,145 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 313505  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:11:52,145 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 313505  - Execute sql: SELECT case when a.EventClass = 92 then 'Data File Auto Grow' when a.EventClass = 93 then 'Log File Auto Grow' end [Type], a.StartTime, a.EndTime, a.ServerName, a.DatabaseName, a.HostName, a.ApplicationName, a.LoginName, a.Duration / 1000 as [Duration (ms)] FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp.trc', 3) a WHERE a.EventClass in (92, 93) order by isnull(a.EndTime, a.StartTime) desc  
2017-03-14 09:12:29,939 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 351299  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:12:31,314 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 352674  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:12:31,314 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 352674  - Execute sql: SELECT top 100 [Procedure], COUNT(*) AS RequestHit, SUM(duration) / 1000000  AS [Duration (s)], SUM(CPU) AS CPU, SUM(Reads) AS Reads, SUM(Writes) AS Writes, SUM(Error) as ErrorHits from (SELECT  CHARINDEX(' ', convert(nvarchar(200), a.TextData) + ' ', 6) as Pos, left(convert(nvarchar(200), a.TextData), CHARINDEX(' ', convert(nvarchar(200), a.TextData) + ' ', 6)) as [Procedure], a.Duration, a.CPU, a.Reads, a.Writes, a.Error FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp.trc', 3) a WHERE a.EventClass in (10, 12)) aa where Pos > 9 group by [Procedure] order by [Duration (s)] desc  
2017-03-14 09:16:24,598 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 585958  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:16:28,614 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 589974  - Execute sql: SELECT top 300 a.TextData, a.HostName, a.ApplicationName, a.LoginName, a.ServerName, a.EventClass, a.Error, a.DatabaseName, a.RowCounts, a.Duration / 1000000 as [Duration (s)], a.StartTime, a.EndTime, a.Reads, a.Writes, a.CPU FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp.trc', 3) a WHERE a.EventClass in (10, 12) order by a.Duration desc  
2017-03-14 09:17:00,083 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 621443  - Execute sql: SELECT top 300 a.TextData, a.HostName, a.ApplicationName, a.LoginName, a.ServerName, a.EventClass, a.Error, a.DatabaseName, a.RowCounts, a.Duration / 1000000 as [Duration (s)], a.StartTime, a.EndTime, a.Reads, a.Writes, a.CPU FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp.trc', 3) a WHERE a.EventClass in (10, 12) order by a.Duration desc  
2017-03-14 09:17:16,771 ERROR FISSOFT\NgocLD Profiler.Form1 ExportCustom 638131  - Exception: You want to put a string longer than 32K to Cell A107. MS Excel only allows to put a string shorter than 32K to a Cell.  
2017-03-14 09:17:22,959 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 644319  - Execute sql: SELECT top 300 a.TextData, a.HostName, a.ApplicationName, a.LoginName, a.ServerName, a.EventClass, a.Error, a.DatabaseName, a.RowCounts, a.Duration / 1000000 as [Duration (s)], a.StartTime, a.EndTime, a.Reads, a.Writes, a.CPU FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp.trc', 3) a WHERE a.EventClass in (10, 12) order by a.Duration desc  
2017-03-14 09:22:18,657 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 940017  - Execute sql: SELECT top 300 a.TextData, a.HostName, a.ApplicationName, a.LoginName, a.ServerName, a.EventClass, a.Error, a.DatabaseName, a.RowCounts, a.Duration / 1000000 as [Duration (s)], a.StartTime, a.EndTime, a.Reads, a.Writes, a.CPU FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp.trc', 3) a WHERE a.EventClass in (10, 12) order by a.Duration desc  
2017-03-14 09:22:34,712 ERROR FISSOFT\NgocLD Profiler.Form1 ExportCustom 956072  - Exception: You want to put a string longer than 32K to Cell A107. MS Excel only allows to put a string shorter than 32K to a Cell.  
2017-03-14 09:23:12,064 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 993423  - Execute sql: SELECT top 300 left(a.TextData, 32000) as TextData, a.HostName, a.ApplicationName, a.LoginName, a.ServerName, a.EventClass, a.Error, a.DatabaseName, a.RowCounts, a.Duration / 1000000 as [Duration (s)], a.StartTime, a.EndTime, a.Reads, a.Writes, a.CPU FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp.trc', 3) a WHERE a.EventClass in (10, 12) order by a.Duration desc  
2017-03-14 09:23:12,079 ERROR FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 993439  - Exception: Argument data type ntext is invalid for argument 1 of left function.  
2017-03-14 09:23:12,079 ERROR FISSOFT\NgocLD Profiler.Form1 ExportCustom 993439  - Exception: Object reference not set to an instance of an object.  
2017-03-14 09:23:20,380 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 1001740  - Execute sql: SELECT top 300 left(a.TextData, 32000) as TextData, a.HostName, a.ApplicationName, a.LoginName, a.ServerName, a.EventClass, a.Error, a.DatabaseName, a.RowCounts, a.Duration / 1000000 as [Duration (s)], a.StartTime, a.EndTime, a.Reads, a.Writes, a.CPU FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp.trc', 3) a WHERE a.EventClass in (10, 12) order by a.Duration desc  
2017-03-14 09:23:20,380 ERROR FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 1001740  - Exception: Argument data type ntext is invalid for argument 1 of left function.  
2017-03-14 09:23:20,380 ERROR FISSOFT\NgocLD Profiler.Form1 ExportCustom 1001740  - Exception: Object reference not set to an instance of an object.  
2017-03-14 09:23:54,305 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 1035665  - Execute sql: SELECT top 300 convert(nvarchar(32000), a.TextData) as TextData, a.HostName, a.ApplicationName, a.LoginName, a.ServerName, a.EventClass, a.Error, a.DatabaseName, a.RowCounts, a.Duration / 1000000 as [Duration (s)], a.StartTime, a.EndTime, a.Reads, a.Writes, a.CPU FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp.trc', 3) a WHERE a.EventClass in (10, 12) order by a.Duration desc  
2017-03-14 09:23:54,305 ERROR FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 1035665  - Exception: The size (32000) given to the type 'nvarchar' exceeds the maximum allowed for any data type (8000).  
2017-03-14 09:23:54,305 ERROR FISSOFT\NgocLD Profiler.Form1 ExportCustom 1035665  - Exception: Object reference not set to an instance of an object.  
2017-03-14 09:26:18,222 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 1179582  - Execute sql: SELECT top 300 convert(ntext, a.TextData) as TextData,
a.HostName, a.ApplicationName, a.LoginName, a.ServerName, a.EventClass, a.Error, a.DatabaseName, a.RowCounts, a.Duration / 1000000 as [Duration (s)], a.StartTime, a.EndTime, a.Reads, a.Writes, a.CPU FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp.trc', 3) a WHERE a.EventClass in (10, 12) order by a.Duration desc  
2017-03-14 09:26:34,052 ERROR FISSOFT\NgocLD Profiler.Form1 ExportCustom 1195412  - Exception: You want to put a string longer than 32K to Cell A107. MS Excel only allows to put a string shorter than 32K to a Cell.  
2017-03-14 09:27:09,934 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 1231294  - Execute sql: SELECT top 300 convert(nvarchar(4000), a.TextData) as TextData,
a.HostName, a.ApplicationName, a.LoginName, a.ServerName, a.EventClass, a.Error, a.DatabaseName, a.RowCounts, a.Duration / 1000000 as [Duration (s)], a.StartTime, a.EndTime, a.Reads, a.Writes, a.CPU FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp.trc', 3) a WHERE a.EventClass in (10, 12) order by a.Duration desc  
2017-03-14 09:28:33,414 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 1314774  - Execute sql: SELECT convert(nvarchar(4000), a.TextData) as TextData,
a.HostName, a.ApplicationName, a.LoginName, a.ServerName, a.EventClass, a.Error, a.DatabaseName, a.RowCounts, a.Duration / 1000000 as [Duration (s)], a.StartTime, a.EndTime, a.Reads, a.Writes, a.CPU 

FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp.trc', 3) a 
WHERE a.EventClass in (10, 12) 
and (a.Duration / 1000000) >= 20
order by a.Duration desc  
2017-03-14 09:31:33,178 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 1494538  - Execute sql: SELECT convert(nvarchar(4000), a.TextData) as TextData,
a.HostName, a.ApplicationName, a.LoginName, a.ServerName, a.EventClass, a.Error, a.DatabaseName, a.RowCounts, a.Duration / 1000000 as [Duration (s)], a.StartTime, a.EndTime, a.Reads, a.Writes, a.CPU 

FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp.trc', 3) a 
WHERE a.EventClass in (10, 12) 
and (a.Duration / 1000000) >= 20
and a.ApplicationName = '.Net SqlClient Data Provider'
order by a.Duration desc  
2017-03-14 09:33:25,121 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 1606481  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:35:17,537 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 1718897  - Execute sql: SELECT top 100 [Procedure], COUNT(*) AS RequestHit, SUM(duration) / 1000000  AS [Duration (s)], SUM(CPU) AS CPU, SUM(Reads) AS Reads, SUM(Writes) AS Writes, SUM(Error) as ErrorHits from (SELECT  CHARINDEX(' ', convert(nvarchar(200), a.TextData) + ' ', 6) as Pos, left(convert(nvarchar(200), a.TextData), CHARINDEX(' ', convert(nvarchar(200), a.TextData) + ' ', 6)) as [Procedure], a.Duration, a.CPU, a.Reads, a.Writes, a.Error 

FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp.trc', 3) a 

WHERE a.EventClass in (10, 12)) aa where Pos > 9 

group by [Procedure] order by [Duration (s)] desc  
2017-03-14 09:38:18,174 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess ExecuteSqlNoTran 1899534  - Execute sql: EXEC sp_trace_setstatus @traceid = 2, @status = 0; EXEC sp_trace_setstatus @traceid = 2, @status = 2  
2017-03-14 09:38:18,189 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 1899549  - Open connection to SQL Server  
2017-03-14 09:38:18,189 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 1899549  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null and is_default = 0;  
2017-03-14 09:38:18,189 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 1899549  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:38:18,189 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 1899549  - Execute sql: SELECT DISTINCT REVERSE(SUBSTRING(REVERSE(path), CHARINDEX('\', REVERSE(path)), 256)) as [DirTrace] FROM sys.traces WHERE max_files is not null and is_default = 0  
2017-03-14 09:39:22,124 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 1963484  - Open connection to SQL Server  
2017-03-14 09:39:24,375 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 1965734  - Open connection to SQL Server  
2017-03-14 09:39:24,375 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 1965734  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null and is_default = 0;  
2017-03-14 09:39:24,390 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 1965750  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:39:24,390 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 1965750  - Execute sql: SELECT DISTINCT REVERSE(SUBSTRING(REVERSE(path), CHARINDEX('\', REVERSE(path)), 256)) as [DirTrace] FROM sys.traces WHERE max_files is not null and is_default = 0  
2017-03-14 09:39:26,156 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess ExecuteSqlNoTran 1967516  - Execute sql: declare @rc INT declare @TraceID INT declare @maxfilesize BIGINT = 300 declare @countfile INT = 30 declare @PathfileLog NVARCHAR(256) = N'D:\Logs\SGT\TraceLog-Monitor\2016-12\traceihrp' exec @rc = sp_trace_create @TraceID output, @options = 2, @tracefile = @PathfileLog, @maxfilesize = @maxfilesize, @stoptime = NULL, @filecount = @countfile declare @on BIT = 1 exec sp_trace_setevent @TraceID, 12, 1, @on exec sp_trace_setevent @TraceID, 12, 9, @on exec sp_trace_setevent @TraceID, 12, 11, @on exec sp_trace_setevent @TraceID, 12, 6, @on exec sp_trace_setevent @TraceID, 12, 8, @on exec sp_trace_setevent @TraceID, 12, 10, @on exec sp_trace_setevent @TraceID, 12, 12, @on exec sp_trace_setevent @TraceID, 12, 13, @on exec sp_trace_setevent @TraceID, 12, 14, @on exec sp_trace_setevent @TraceID, 12, 15, @on exec sp_trace_setevent @TraceID, 12, 16, @on exec sp_trace_setevent @TraceID, 12, 17, @on exec sp_trace_setevent @TraceID, 12, 18, @on exec sp_trace_setevent @TraceID, 12, 31, @on exec sp_trace_setevent @TraceID, 12, 35, @on exec sp_trace_setevent @TraceID, 12, 48, @on exec sp_trace_setevent @TraceID, 12, 60, @on exec sp_trace_setevent @TraceID, 81, 12, @on exec sp_trace_setevent @TraceID, 81, 14, @on exec sp_trace_setevent @TraceID, 81, 21, @on exec sp_trace_setevent @TraceID, 81, 25, @on exec sp_trace_setevent @TraceID, 81, 26, @on exec sp_trace_setevent @TraceID, 81, 51, @on exec sp_trace_setevent @TraceID, 81, 60, @on exec sp_trace_setevent @TraceID, 81, 64, @on exec sp_trace_setevent @TraceID, 92, 3, @on exec sp_trace_setevent @TraceID, 92, 11, @on exec sp_trace_setevent @TraceID, 92, 8, @on exec sp_trace_setevent @TraceID, 92, 10, @on exec sp_trace_setevent @TraceID, 92, 12, @on exec sp_trace_setevent @TraceID, 92, 13, @on exec sp_trace_setevent @TraceID, 92, 14, @on exec sp_trace_setevent @TraceID, 92, 15, @on exec sp_trace_setevent @TraceID, 92, 25, @on exec sp_trace_setevent @TraceID, 92, 26, @on exec sp_trace_setevent @TraceID, 92, 35, @on exec sp_trace_setevent @TraceID, 92, 51, @on exec sp_trace_setevent @TraceID, 92, 60, @on exec sp_trace_setevent @TraceID, 92, 64, @on exec sp_trace_setevent @TraceID, 94, 3, @on exec sp_trace_setevent @TraceID, 94, 11, @on exec sp_trace_setevent @TraceID, 94, 8, @on exec sp_trace_setevent @TraceID, 94, 10, @on exec sp_trace_setevent @TraceID, 94, 12, @on exec sp_trace_setevent @TraceID, 94, 13, @on exec sp_trace_setevent @TraceID, 94, 14, @on exec sp_trace_setevent @TraceID, 94, 15, @on exec sp_trace_setevent @TraceID, 94, 25, @on exec sp_trace_setevent @TraceID, 94, 26, @on exec sp_trace_setevent @TraceID, 94, 35, @on exec sp_trace_setevent @TraceID, 94, 51, @on exec sp_trace_setevent @TraceID, 94, 60, @on exec sp_trace_setevent @TraceID, 94, 64, @on exec sp_trace_setevent @TraceID, 93, 3, @on exec sp_trace_setevent @TraceID, 93, 11, @on exec sp_trace_setevent @TraceID, 93, 8, @on exec sp_trace_setevent @TraceID, 93, 10, @on exec sp_trace_setevent @TraceID, 93, 12, @on exec sp_trace_setevent @TraceID, 93, 13, @on exec sp_trace_setevent @TraceID, 93, 14, @on exec sp_trace_setevent @TraceID, 93, 15, @on exec sp_trace_setevent @TraceID, 93, 25, @on exec sp_trace_setevent @TraceID, 93, 26, @on exec sp_trace_setevent @TraceID, 93, 35, @on exec sp_trace_setevent @TraceID, 93, 51, @on exec sp_trace_setevent @TraceID, 93, 60, @on exec sp_trace_setevent @TraceID, 93, 64, @on exec sp_trace_setevent @TraceID, 95, 3, @on exec sp_trace_setevent @TraceID, 95, 11, @on exec sp_trace_setevent @TraceID, 95, 8, @on exec sp_trace_setevent @TraceID, 95, 10, @on exec sp_trace_setevent @TraceID, 95, 12, @on exec sp_trace_setevent @TraceID, 95, 13, @on exec sp_trace_setevent @TraceID, 95, 14, @on exec sp_trace_setevent @TraceID, 95, 15, @on exec sp_trace_setevent @TraceID, 95, 25, @on exec sp_trace_setevent @TraceID, 95, 26, @on exec sp_trace_setevent @TraceID, 95, 35, @on exec sp_trace_setevent @TraceID, 95, 51, @on exec sp_trace_setevent @TraceID, 95, 60, @on exec sp_trace_setevent @TraceID, 95, 64, @on exec sp_trace_setevent @TraceID, 25, 1, @on exec sp_trace_setevent @TraceID, 25, 9, @on exec sp_trace_setevent @TraceID, 25, 10, @on exec sp_trace_setevent @TraceID, 25, 3, @on exec sp_trace_setevent @TraceID, 25, 8, @on exec sp_trace_setevent @TraceID, 25, 11, @on exec sp_trace_setevent @TraceID, 25, 12, @on exec sp_trace_setevent @TraceID, 25, 13, @on exec sp_trace_setevent @TraceID, 25, 14, @on exec sp_trace_setevent @TraceID, 25, 15, @on exec sp_trace_setevent @TraceID, 25, 26, @on exec sp_trace_setevent @TraceID, 25, 32, @on exec sp_trace_setevent @TraceID, 25, 35, @on exec sp_trace_setevent @TraceID, 25, 57, @on exec sp_trace_setevent @TraceID, 25, 60, @on exec sp_trace_setevent @TraceID, 25, 64, @on exec sp_trace_setevent @TraceID, 10, 1, @on exec sp_trace_setevent @TraceID, 10, 9, @on exec sp_trace_setevent @TraceID, 10, 2, @on exec sp_trace_setevent @TraceID, 10, 10, @on exec sp_trace_setevent @TraceID, 10, 3, @on exec sp_trace_setevent @TraceID, 10, 6, @on exec sp_trace_setevent @TraceID, 10, 8, @on exec sp_trace_setevent @TraceID, 10, 11, @on exec sp_trace_setevent @TraceID, 10, 12, @on exec sp_trace_setevent @TraceID, 10, 13, @on exec sp_trace_setevent @TraceID, 10, 14, @on exec sp_trace_setevent @TraceID, 10, 15, @on exec sp_trace_setevent @TraceID, 10, 16, @on exec sp_trace_setevent @TraceID, 10, 17, @on exec sp_trace_setevent @TraceID, 10, 18, @on exec sp_trace_setevent @TraceID, 10, 26, @on exec sp_trace_setevent @TraceID, 10, 31, @on exec sp_trace_setevent @TraceID, 10, 35, @on exec sp_trace_setevent @TraceID, 10, 48, @on exec sp_trace_setfilter @TraceID, 10, 0, 7, N'Microsoft SQL Server Management Studio - Transact-SQL IntelliSense' exec sp_trace_setfilter @TraceID, 10, 0, 7, N'SQL Trace Log iHRP' exec sp_trace_setfilter @TraceID, 1, 0, 7, N'exec sp_reset_connection' exec sp_trace_setstatus @TraceID, 1   
2017-03-14 09:39:26,156 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 1967516  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null and is_default = 0;  
2017-03-14 09:39:27,250 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 1968610  - Open connection to SQL Server  
2017-03-14 09:39:27,375 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 1968735  - Open connection to SQL Server  
2017-03-14 09:39:27,375 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 1968735  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null and is_default = 0;  
2017-03-14 09:39:27,390 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 1968750  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:39:27,390 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 1968750  - Execute sql: SELECT DISTINCT REVERSE(SUBSTRING(REVERSE(path), CHARINDEX('\', REVERSE(path)), 256)) as [DirTrace] FROM sys.traces WHERE max_files is not null and is_default = 0  
2017-03-14 09:39:27,390 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 1968750  - Execute sql: EXEC master.sys.xp_dirtree 'D:\Logs\SGT\TraceLog-Monitor\2016-12\',1,1  
2017-03-14 09:39:34,687 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 1976047  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('D:\Logs\SGT\TraceLog-Monitor\2016-12\\traceihrp_6.trc', 3) a  
2017-03-14 09:39:48,993 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 1990352  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('D:\Logs\SGT\TraceLog-Monitor\2016-12\\traceihrp_8.trc', 3) a  
2017-03-14 09:39:55,954 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 1997314  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('D:\Logs\SGT\TraceLog-Monitor\2016-12\\traceihrp_7.trc', 3) a  
2017-03-14 09:40:02,883 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 2004243  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('D:\Logs\SGT\TraceLog-Monitor\2016-12\\traceihrp_6.trc', 3) a  
2017-03-14 09:40:06,587 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 2007947  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('D:\Logs\SGT\TraceLog-Monitor\2016-12\\traceihrp_6.trc', 2) a  
2017-03-14 09:40:11,016 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 2012376  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('D:\Logs\SGT\TraceLog-Monitor\2016-12\\traceihrp_6.trc', 2) a  
2017-03-14 09:40:29,166 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 2030526  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:40:30,088 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 2031448  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:40:30,088 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 2031448  - Execute sql: SELECT top 100 a.TextData, a.HostName, a.ApplicationName, a.LoginName, a.ServerName, a.EventClass, a.Error, a.DatabaseName, a.RowCounts, a.Duration / 1000000 as [Duration (s)], a.StartTime, a.EndTime, a.Reads, a.Writes, a.CPU FROM sys.fn_trace_gettable('D:\Logs\SGT\TraceLog-Monitor\2016-12\\traceihrp_6.trc', 2) a WHERE a.EventClass in (10, 12) order by a.Duration desc  
2017-03-14 09:41:54,536 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 2115896  - Execute sql: SELECT top 100 a.TextData, a.HostName, a.ApplicationName, a.LoginName, a.ServerName, a.EventClass, a.Error, a.DatabaseName, a.RowCounts, a.Duration / 1000000 as [Duration (s)], a.StartTime, a.EndTime, a.Reads, a.Writes, a.CPU FROM sys.fn_trace_gettable('D:\Logs\SGT\TraceLog-Monitor\2016-12\\traceihrp_6.trc', 2) a WHERE a.EventClass in (10, 12) order by a.Duration desc  
2017-03-14 09:43:50,890 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 2232250  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('D:\Logs\SGT\TraceLog-Monitor\2016-12\\traceihrp_6.trc', 1) a  
2017-03-14 09:44:00,289 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 2241649  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('D:\Logs\SGT\TraceLog-Monitor\2016-12\\traceihrp_7.trc', 1) a  
2017-03-14 09:44:43,900 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 2285260  - Execute sql: SELECT a.TextData, a.HostName, a.ApplicationName, a.LoginName, a.ServerName, a.EventClass, a.Error, a.DatabaseName, a.RowCounts, a.Duration / 1000000 as [Duration (s)], a.StartTime, a.EndTime, a.Reads, a.Writes, a.CPU 
FROM sys.fn_trace_gettable('D:\Logs\SGT\TraceLog-Monitor\2016-12\\traceihrp_7.trc', 1) a 
WHERE a.EventClass in (10, 12) 
	and a.ApplicationName = '.Net SqlClient Data Provider'
	and (a.Duration / 1000000) >= 10
order by a.Duration desc  
2017-03-14 09:45:01,385 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 2302745  - Execute sql: SELECT a.TextData, a.HostName, a.ApplicationName, a.LoginName, a.ServerName, a.EventClass, a.Error, a.DatabaseName, a.RowCounts, a.Duration / 1000000 as [Duration (s)], a.StartTime, a.EndTime, a.Reads, a.Writes, a.CPU 
FROM sys.fn_trace_gettable('D:\Logs\SGT\TraceLog-Monitor\2016-12\\traceihrp_7.trc', 1) a 
WHERE a.EventClass in (10, 12) 
	and a.ApplicationName = '.Net SqlClient Data Provider'
	and (a.Duration / 1000000) >= 10
order by a.Duration desc  
2017-03-14 09:47:57,872 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 2479232  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:47:59,356 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 2480716  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:47:59,356 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 2480716  - Execute sql: SELECT top 100 [Procedure], COUNT(*) AS RequestHit, SUM(duration) / 1000000  AS [Duration (s)], SUM(CPU) AS CPU, SUM(Reads) AS Reads, SUM(Writes) AS Writes, SUM(Error) as ErrorHits from (SELECT  CHARINDEX(' ', convert(nvarchar(200), a.TextData) + ' ', 6) as Pos, left(convert(nvarchar(200), a.TextData), CHARINDEX(' ', convert(nvarchar(200), a.TextData) + ' ', 6)) as [Procedure], a.Duration, a.CPU, a.Reads, a.Writes, a.Error FROM sys.fn_trace_gettable('D:\Logs\SGT\TraceLog-Monitor\2016-12\\traceihrp_7.trc', 1) a WHERE a.EventClass in (10, 12)) aa where Pos > 9 group by [Procedure] order by [Duration (s)] desc  
2017-03-14 09:52:08,806 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 407  - Open connection to SQL Server  
2017-03-14 09:52:08,869 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 469  - Open connection to SQL Server  
2017-03-14 09:52:08,885 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 485  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null and is_default = 0;  
2017-03-14 09:52:08,900 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 500  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:52:08,916 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 516  - Execute sql: SELECT DISTINCT REVERSE(SUBSTRING(REVERSE(path), CHARINDEX('\', REVERSE(path)), 256)) as [DirTrace] FROM sys.traces WHERE max_files is not null and is_default = 0  
2017-03-14 09:52:08,916 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 516  - Execute sql: EXEC master.sys.xp_dirtree 'D:\Logs\SGT\TraceLog-Monitor\2016-12\',1,1  
2017-03-14 09:52:08,931 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 532  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:52:12,666 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 4267  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('D:\Logs\SGT\TraceLog-Monitor\2016-12\\traceihrp_6.trc', 1) a  
2017-03-14 09:52:13,652 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess ExecuteSqlNoTran 5252  - Execute sql: EXEC sp_trace_setstatus @traceid = 2, @status = 0; EXEC sp_trace_setstatus @traceid = 2, @status = 2  
2017-03-14 09:52:13,652 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 5252  - Open connection to SQL Server  
2017-03-14 09:52:13,652 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 5252  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null and is_default = 0;  
2017-03-14 09:52:13,667 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 5267  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:52:13,667 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 5267  - Execute sql: SELECT DISTINCT REVERSE(SUBSTRING(REVERSE(path), CHARINDEX('\', REVERSE(path)), 256)) as [DirTrace] FROM sys.traces WHERE max_files is not null and is_default = 0  
2017-03-14 09:52:32,586 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 24186  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('D:\Logs\SGT\TraceLog-Monitor\2016-12\\traceihrp_6.trc', 1) a  
2017-03-14 09:52:34,586 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 26186  - Open connection to SQL Server  
2017-03-14 09:52:34,586 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 26186  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null and is_default = 0;  
2017-03-14 09:52:34,602 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 26202  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:52:34,602 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 26202  - Execute sql: SELECT DISTINCT REVERSE(SUBSTRING(REVERSE(path), CHARINDEX('\', REVERSE(path)), 256)) as [DirTrace] FROM sys.traces WHERE max_files is not null and is_default = 0  
2017-03-14 09:52:35,086 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess ExecuteSqlNoTran 26686  - Execute sql: declare @rc INT declare @TraceID INT declare @maxfilesize BIGINT = 300 declare @countfile INT = 30 declare @PathfileLog NVARCHAR(256) = N'E:\Temp\LinhNV\traceihrp' exec @rc = sp_trace_create @TraceID output, @options = 2, @tracefile = @PathfileLog, @maxfilesize = @maxfilesize, @stoptime = NULL, @filecount = @countfile declare @on BIT = 1 exec sp_trace_setevent @TraceID, 12, 1, @on exec sp_trace_setevent @TraceID, 12, 9, @on exec sp_trace_setevent @TraceID, 12, 11, @on exec sp_trace_setevent @TraceID, 12, 6, @on exec sp_trace_setevent @TraceID, 12, 8, @on exec sp_trace_setevent @TraceID, 12, 10, @on exec sp_trace_setevent @TraceID, 12, 12, @on exec sp_trace_setevent @TraceID, 12, 13, @on exec sp_trace_setevent @TraceID, 12, 14, @on exec sp_trace_setevent @TraceID, 12, 15, @on exec sp_trace_setevent @TraceID, 12, 16, @on exec sp_trace_setevent @TraceID, 12, 17, @on exec sp_trace_setevent @TraceID, 12, 18, @on exec sp_trace_setevent @TraceID, 12, 31, @on exec sp_trace_setevent @TraceID, 12, 35, @on exec sp_trace_setevent @TraceID, 12, 48, @on exec sp_trace_setevent @TraceID, 12, 60, @on exec sp_trace_setevent @TraceID, 81, 12, @on exec sp_trace_setevent @TraceID, 81, 14, @on exec sp_trace_setevent @TraceID, 81, 21, @on exec sp_trace_setevent @TraceID, 81, 25, @on exec sp_trace_setevent @TraceID, 81, 26, @on exec sp_trace_setevent @TraceID, 81, 51, @on exec sp_trace_setevent @TraceID, 81, 60, @on exec sp_trace_setevent @TraceID, 81, 64, @on exec sp_trace_setevent @TraceID, 92, 3, @on exec sp_trace_setevent @TraceID, 92, 11, @on exec sp_trace_setevent @TraceID, 92, 8, @on exec sp_trace_setevent @TraceID, 92, 10, @on exec sp_trace_setevent @TraceID, 92, 12, @on exec sp_trace_setevent @TraceID, 92, 13, @on exec sp_trace_setevent @TraceID, 92, 14, @on exec sp_trace_setevent @TraceID, 92, 15, @on exec sp_trace_setevent @TraceID, 92, 25, @on exec sp_trace_setevent @TraceID, 92, 26, @on exec sp_trace_setevent @TraceID, 92, 35, @on exec sp_trace_setevent @TraceID, 92, 51, @on exec sp_trace_setevent @TraceID, 92, 60, @on exec sp_trace_setevent @TraceID, 92, 64, @on exec sp_trace_setevent @TraceID, 94, 3, @on exec sp_trace_setevent @TraceID, 94, 11, @on exec sp_trace_setevent @TraceID, 94, 8, @on exec sp_trace_setevent @TraceID, 94, 10, @on exec sp_trace_setevent @TraceID, 94, 12, @on exec sp_trace_setevent @TraceID, 94, 13, @on exec sp_trace_setevent @TraceID, 94, 14, @on exec sp_trace_setevent @TraceID, 94, 15, @on exec sp_trace_setevent @TraceID, 94, 25, @on exec sp_trace_setevent @TraceID, 94, 26, @on exec sp_trace_setevent @TraceID, 94, 35, @on exec sp_trace_setevent @TraceID, 94, 51, @on exec sp_trace_setevent @TraceID, 94, 60, @on exec sp_trace_setevent @TraceID, 94, 64, @on exec sp_trace_setevent @TraceID, 93, 3, @on exec sp_trace_setevent @TraceID, 93, 11, @on exec sp_trace_setevent @TraceID, 93, 8, @on exec sp_trace_setevent @TraceID, 93, 10, @on exec sp_trace_setevent @TraceID, 93, 12, @on exec sp_trace_setevent @TraceID, 93, 13, @on exec sp_trace_setevent @TraceID, 93, 14, @on exec sp_trace_setevent @TraceID, 93, 15, @on exec sp_trace_setevent @TraceID, 93, 25, @on exec sp_trace_setevent @TraceID, 93, 26, @on exec sp_trace_setevent @TraceID, 93, 35, @on exec sp_trace_setevent @TraceID, 93, 51, @on exec sp_trace_setevent @TraceID, 93, 60, @on exec sp_trace_setevent @TraceID, 93, 64, @on exec sp_trace_setevent @TraceID, 95, 3, @on exec sp_trace_setevent @TraceID, 95, 11, @on exec sp_trace_setevent @TraceID, 95, 8, @on exec sp_trace_setevent @TraceID, 95, 10, @on exec sp_trace_setevent @TraceID, 95, 12, @on exec sp_trace_setevent @TraceID, 95, 13, @on exec sp_trace_setevent @TraceID, 95, 14, @on exec sp_trace_setevent @TraceID, 95, 15, @on exec sp_trace_setevent @TraceID, 95, 25, @on exec sp_trace_setevent @TraceID, 95, 26, @on exec sp_trace_setevent @TraceID, 95, 35, @on exec sp_trace_setevent @TraceID, 95, 51, @on exec sp_trace_setevent @TraceID, 95, 60, @on exec sp_trace_setevent @TraceID, 95, 64, @on exec sp_trace_setevent @TraceID, 25, 1, @on exec sp_trace_setevent @TraceID, 25, 9, @on exec sp_trace_setevent @TraceID, 25, 10, @on exec sp_trace_setevent @TraceID, 25, 3, @on exec sp_trace_setevent @TraceID, 25, 8, @on exec sp_trace_setevent @TraceID, 25, 11, @on exec sp_trace_setevent @TraceID, 25, 12, @on exec sp_trace_setevent @TraceID, 25, 13, @on exec sp_trace_setevent @TraceID, 25, 14, @on exec sp_trace_setevent @TraceID, 25, 15, @on exec sp_trace_setevent @TraceID, 25, 26, @on exec sp_trace_setevent @TraceID, 25, 32, @on exec sp_trace_setevent @TraceID, 25, 35, @on exec sp_trace_setevent @TraceID, 25, 57, @on exec sp_trace_setevent @TraceID, 25, 60, @on exec sp_trace_setevent @TraceID, 25, 64, @on exec sp_trace_setevent @TraceID, 10, 1, @on exec sp_trace_setevent @TraceID, 10, 9, @on exec sp_trace_setevent @TraceID, 10, 2, @on exec sp_trace_setevent @TraceID, 10, 10, @on exec sp_trace_setevent @TraceID, 10, 3, @on exec sp_trace_setevent @TraceID, 10, 6, @on exec sp_trace_setevent @TraceID, 10, 8, @on exec sp_trace_setevent @TraceID, 10, 11, @on exec sp_trace_setevent @TraceID, 10, 12, @on exec sp_trace_setevent @TraceID, 10, 13, @on exec sp_trace_setevent @TraceID, 10, 14, @on exec sp_trace_setevent @TraceID, 10, 15, @on exec sp_trace_setevent @TraceID, 10, 16, @on exec sp_trace_setevent @TraceID, 10, 17, @on exec sp_trace_setevent @TraceID, 10, 18, @on exec sp_trace_setevent @TraceID, 10, 26, @on exec sp_trace_setevent @TraceID, 10, 31, @on exec sp_trace_setevent @TraceID, 10, 35, @on exec sp_trace_setevent @TraceID, 10, 48, @on exec sp_trace_setfilter @TraceID, 10, 0, 7, N'Microsoft SQL Server Management Studio - Transact-SQL IntelliSense' exec sp_trace_setfilter @TraceID, 10, 0, 7, N'SQL Trace Log iHRP' exec sp_trace_setfilter @TraceID, 1, 0, 7, N'exec sp_reset_connection' exec sp_trace_setstatus @TraceID, 1   
2017-03-14 09:52:35,086 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 26686  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null and is_default = 0;  
2017-03-14 09:52:35,943 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 27543  - Open connection to SQL Server  
2017-03-14 09:52:37,474 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 29074  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('D:\Logs\SGT\TraceLog-Monitor\2016-12\\traceihrp_6.trc', 1) a  
2017-03-14 09:52:37,599 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 29199  - Open connection to SQL Server  
2017-03-14 09:52:37,599 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 29199  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null and is_default = 0;  
2017-03-14 09:52:37,614 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 29215  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:52:37,614 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 29215  - Execute sql: SELECT DISTINCT REVERSE(SUBSTRING(REVERSE(path), CHARINDEX('\', REVERSE(path)), 256)) as [DirTrace] FROM sys.traces WHERE max_files is not null and is_default = 0  
2017-03-14 09:52:37,614 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 29215  - Execute sql: EXEC master.sys.xp_dirtree 'E:\Temp\LinhNV\',1,1  
2017-03-14 09:52:41,693 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 33293  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp.trc', 1) a  
2017-03-14 09:53:14,561 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 66162  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp_1.trc', 3) a  
2017-03-14 09:53:28,390 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 79990  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp_2.trc', 3) a  
2017-03-14 09:53:40,587 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 92188  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp_1.trc', 3) a  
2017-03-14 09:53:58,541 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 110141  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp.trc', 3) a  
2017-03-14 09:54:17,988 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 129588  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp_1.trc', 3) a  
2017-03-14 09:54:35,536 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 147136  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp.trc', 3) a  
2017-03-14 09:55:05,113 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 176714  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp_1.trc', 3) a  
2017-03-14 09:55:28,990 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 200590  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp.trc', 3) a  
2017-03-14 09:55:39,936 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 211537  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 09:56:37,887 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 269487  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp_1.trc', 1) a  
2017-03-14 09:57:10,881 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 302481  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp.trc', 1) a  
2017-03-14 09:57:29,179 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 320779  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp_2.trc', 1) a  
2017-03-14 11:32:03,091 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 468  - Open connection to SQL Server  
2017-03-14 11:32:03,164 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 541  - Open connection to SQL Server  
2017-03-14 11:32:03,169 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 546  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null and is_default = 0;  
2017-03-14 11:32:03,208 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 585  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 11:32:03,210 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 587  - Execute sql: SELECT DISTINCT REVERSE(SUBSTRING(REVERSE(path), CHARINDEX('\', REVERSE(path)), 256)) as [DirTrace] FROM sys.traces WHERE max_files is not null and is_default = 0  
2017-03-14 11:32:03,211 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 588  - Execute sql: EXEC master.sys.xp_dirtree 'E:\Temp\LinhNV\',1,1  
2017-03-14 11:32:03,251 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 628  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 11:32:14,134 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 11511  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('E:\Temp\LinhNV\\traceihrp.trc', 1) a  
2017-03-14 11:32:15,663 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 13040  - Open connection to SQL Server  
2017-03-14 11:32:18,069 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 15446  - Open connection to SQL Server  
2017-03-14 11:32:18,070 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 15447  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null and is_default = 0;  
2017-03-14 11:32:18,090 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 15467  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 11:32:18,093 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 15470  - Execute sql: SELECT DISTINCT REVERSE(SUBSTRING(REVERSE(path), CHARINDEX('\', REVERSE(path)), 256)) as [DirTrace] FROM sys.traces WHERE max_files is not null and is_default = 0  
2017-03-14 11:32:18,094 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 15471  - Execute sql: EXEC master.sys.xp_dirtree 'E:\Temp\LinhNV\',1,1  
2017-03-14 11:32:20,288 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess ExecuteSqlNoTran 17665  - Execute sql: EXEC sp_trace_setstatus @traceid = 2, @status = 0; EXEC sp_trace_setstatus @traceid = 2, @status = 2  
2017-03-14 11:32:20,296 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 17673  - Open connection to SQL Server  
2017-03-14 11:32:20,297 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 17674  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null and is_default = 0;  
2017-03-14 11:32:20,312 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 17689  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 11:32:20,315 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 17692  - Execute sql: SELECT DISTINCT REVERSE(SUBSTRING(REVERSE(path), CHARINDEX('\', REVERSE(path)), 256)) as [DirTrace] FROM sys.traces WHERE max_files is not null and is_default = 0  
2017-03-14 11:32:21,017 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 18394  - Open connection to SQL Server  
2017-03-14 11:32:21,018 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 18395  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null and is_default = 0;  
2017-03-14 11:32:21,030 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 18407  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 11:32:21,039 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 18416  - Execute sql: SELECT DISTINCT REVERSE(SUBSTRING(REVERSE(path), CHARINDEX('\', REVERSE(path)), 256)) as [DirTrace] FROM sys.traces WHERE max_files is not null and is_default = 0  
2017-03-14 11:32:21,179 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 18556  - Open connection to SQL Server  
2017-03-14 11:32:21,181 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 18558  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null and is_default = 0;  
2017-03-14 11:32:21,195 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 18572  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 11:32:21,198 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 18575  - Execute sql: SELECT DISTINCT REVERSE(SUBSTRING(REVERSE(path), CHARINDEX('\', REVERSE(path)), 256)) as [DirTrace] FROM sys.traces WHERE max_files is not null and is_default = 0  
2017-03-14 11:32:21,793 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess ExecuteSqlNoTran 19170  - Execute sql: declare @rc INT declare @TraceID INT declare @maxfilesize BIGINT = 300 declare @countfile INT = 30 declare @PathfileLog NVARCHAR(256) = N'E:\TraceLogs\FECredit\2017-03\traceihrp' exec @rc = sp_trace_create @TraceID output, @options = 2, @tracefile = @PathfileLog, @maxfilesize = @maxfilesize, @stoptime = NULL, @filecount = @countfile declare @on BIT = 1 exec sp_trace_setevent @TraceID, 12, 1, @on exec sp_trace_setevent @TraceID, 12, 9, @on exec sp_trace_setevent @TraceID, 12, 11, @on exec sp_trace_setevent @TraceID, 12, 6, @on exec sp_trace_setevent @TraceID, 12, 8, @on exec sp_trace_setevent @TraceID, 12, 10, @on exec sp_trace_setevent @TraceID, 12, 12, @on exec sp_trace_setevent @TraceID, 12, 13, @on exec sp_trace_setevent @TraceID, 12, 14, @on exec sp_trace_setevent @TraceID, 12, 15, @on exec sp_trace_setevent @TraceID, 12, 16, @on exec sp_trace_setevent @TraceID, 12, 17, @on exec sp_trace_setevent @TraceID, 12, 18, @on exec sp_trace_setevent @TraceID, 12, 31, @on exec sp_trace_setevent @TraceID, 12, 35, @on exec sp_trace_setevent @TraceID, 12, 48, @on exec sp_trace_setevent @TraceID, 12, 60, @on exec sp_trace_setevent @TraceID, 81, 12, @on exec sp_trace_setevent @TraceID, 81, 14, @on exec sp_trace_setevent @TraceID, 81, 21, @on exec sp_trace_setevent @TraceID, 81, 25, @on exec sp_trace_setevent @TraceID, 81, 26, @on exec sp_trace_setevent @TraceID, 81, 51, @on exec sp_trace_setevent @TraceID, 81, 60, @on exec sp_trace_setevent @TraceID, 81, 64, @on exec sp_trace_setevent @TraceID, 92, 3, @on exec sp_trace_setevent @TraceID, 92, 11, @on exec sp_trace_setevent @TraceID, 92, 8, @on exec sp_trace_setevent @TraceID, 92, 10, @on exec sp_trace_setevent @TraceID, 92, 12, @on exec sp_trace_setevent @TraceID, 92, 13, @on exec sp_trace_setevent @TraceID, 92, 14, @on exec sp_trace_setevent @TraceID, 92, 15, @on exec sp_trace_setevent @TraceID, 92, 25, @on exec sp_trace_setevent @TraceID, 92, 26, @on exec sp_trace_setevent @TraceID, 92, 35, @on exec sp_trace_setevent @TraceID, 92, 51, @on exec sp_trace_setevent @TraceID, 92, 60, @on exec sp_trace_setevent @TraceID, 92, 64, @on exec sp_trace_setevent @TraceID, 94, 3, @on exec sp_trace_setevent @TraceID, 94, 11, @on exec sp_trace_setevent @TraceID, 94, 8, @on exec sp_trace_setevent @TraceID, 94, 10, @on exec sp_trace_setevent @TraceID, 94, 12, @on exec sp_trace_setevent @TraceID, 94, 13, @on exec sp_trace_setevent @TraceID, 94, 14, @on exec sp_trace_setevent @TraceID, 94, 15, @on exec sp_trace_setevent @TraceID, 94, 25, @on exec sp_trace_setevent @TraceID, 94, 26, @on exec sp_trace_setevent @TraceID, 94, 35, @on exec sp_trace_setevent @TraceID, 94, 51, @on exec sp_trace_setevent @TraceID, 94, 60, @on exec sp_trace_setevent @TraceID, 94, 64, @on exec sp_trace_setevent @TraceID, 93, 3, @on exec sp_trace_setevent @TraceID, 93, 11, @on exec sp_trace_setevent @TraceID, 93, 8, @on exec sp_trace_setevent @TraceID, 93, 10, @on exec sp_trace_setevent @TraceID, 93, 12, @on exec sp_trace_setevent @TraceID, 93, 13, @on exec sp_trace_setevent @TraceID, 93, 14, @on exec sp_trace_setevent @TraceID, 93, 15, @on exec sp_trace_setevent @TraceID, 93, 25, @on exec sp_trace_setevent @TraceID, 93, 26, @on exec sp_trace_setevent @TraceID, 93, 35, @on exec sp_trace_setevent @TraceID, 93, 51, @on exec sp_trace_setevent @TraceID, 93, 60, @on exec sp_trace_setevent @TraceID, 93, 64, @on exec sp_trace_setevent @TraceID, 95, 3, @on exec sp_trace_setevent @TraceID, 95, 11, @on exec sp_trace_setevent @TraceID, 95, 8, @on exec sp_trace_setevent @TraceID, 95, 10, @on exec sp_trace_setevent @TraceID, 95, 12, @on exec sp_trace_setevent @TraceID, 95, 13, @on exec sp_trace_setevent @TraceID, 95, 14, @on exec sp_trace_setevent @TraceID, 95, 15, @on exec sp_trace_setevent @TraceID, 95, 25, @on exec sp_trace_setevent @TraceID, 95, 26, @on exec sp_trace_setevent @TraceID, 95, 35, @on exec sp_trace_setevent @TraceID, 95, 51, @on exec sp_trace_setevent @TraceID, 95, 60, @on exec sp_trace_setevent @TraceID, 95, 64, @on exec sp_trace_setevent @TraceID, 25, 1, @on exec sp_trace_setevent @TraceID, 25, 9, @on exec sp_trace_setevent @TraceID, 25, 10, @on exec sp_trace_setevent @TraceID, 25, 3, @on exec sp_trace_setevent @TraceID, 25, 8, @on exec sp_trace_setevent @TraceID, 25, 11, @on exec sp_trace_setevent @TraceID, 25, 12, @on exec sp_trace_setevent @TraceID, 25, 13, @on exec sp_trace_setevent @TraceID, 25, 14, @on exec sp_trace_setevent @TraceID, 25, 15, @on exec sp_trace_setevent @TraceID, 25, 26, @on exec sp_trace_setevent @TraceID, 25, 32, @on exec sp_trace_setevent @TraceID, 25, 35, @on exec sp_trace_setevent @TraceID, 25, 57, @on exec sp_trace_setevent @TraceID, 25, 60, @on exec sp_trace_setevent @TraceID, 25, 64, @on exec sp_trace_setevent @TraceID, 10, 1, @on exec sp_trace_setevent @TraceID, 10, 9, @on exec sp_trace_setevent @TraceID, 10, 2, @on exec sp_trace_setevent @TraceID, 10, 10, @on exec sp_trace_setevent @TraceID, 10, 3, @on exec sp_trace_setevent @TraceID, 10, 6, @on exec sp_trace_setevent @TraceID, 10, 8, @on exec sp_trace_setevent @TraceID, 10, 11, @on exec sp_trace_setevent @TraceID, 10, 12, @on exec sp_trace_setevent @TraceID, 10, 13, @on exec sp_trace_setevent @TraceID, 10, 14, @on exec sp_trace_setevent @TraceID, 10, 15, @on exec sp_trace_setevent @TraceID, 10, 16, @on exec sp_trace_setevent @TraceID, 10, 17, @on exec sp_trace_setevent @TraceID, 10, 18, @on exec sp_trace_setevent @TraceID, 10, 26, @on exec sp_trace_setevent @TraceID, 10, 31, @on exec sp_trace_setevent @TraceID, 10, 35, @on exec sp_trace_setevent @TraceID, 10, 48, @on exec sp_trace_setfilter @TraceID, 10, 0, 7, N'Microsoft SQL Server Management Studio - Transact-SQL IntelliSense' exec sp_trace_setfilter @TraceID, 10, 0, 7, N'SQL Trace Log iHRP' exec sp_trace_setfilter @TraceID, 1, 0, 7, N'exec sp_reset_connection' exec sp_trace_setstatus @TraceID, 1   
2017-03-14 11:32:21,802 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 19179  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null and is_default = 0;  
2017-03-14 11:32:23,007 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 20384  - Open connection to SQL Server  
2017-03-14 11:32:23,137 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 20514  - Open connection to SQL Server  
2017-03-14 11:32:23,138 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 20515  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null and is_default = 0;  
2017-03-14 11:32:23,156 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 20533  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 11:32:23,158 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 20535  - Execute sql: SELECT DISTINCT REVERSE(SUBSTRING(REVERSE(path), CHARINDEX('\', REVERSE(path)), 256)) as [DirTrace] FROM sys.traces WHERE max_files is not null and is_default = 0  
2017-03-14 11:32:23,159 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 20536  - Execute sql: EXEC master.sys.xp_dirtree 'E:\TraceLogs\FECredit\2017-03\',1,1  
2017-03-14 11:32:41,702 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 39079  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('E:\TraceLogs\FECredit\2017-03\\traceihrp_56.trc', 1) a  
2017-03-14 11:32:53,518 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 50895  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('E:\TraceLogs\FECredit\2017-03\\traceihrp_56.trc', 1) a  
2017-03-14 11:33:03,253 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 60630  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 11:33:03,254 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 60631  - Execute sql: SELECT case when a.EventClass = 92 then 'Data File Auto Grow' when a.EventClass = 93 then 'Log File Auto Grow' end [Type], a.StartTime, a.EndTime, a.ServerName, a.DatabaseName, a.HostName, a.ApplicationName, a.LoginName, a.Duration / 1000 as [Duration (ms)] FROM sys.fn_trace_gettable('E:\TraceLogs\FECredit\2017-03\\traceihrp_56.trc', 1) a WHERE a.EventClass in (92, 93) order by isnull(a.EndTime, a.StartTime) desc  
2017-03-14 11:33:44,334 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 101711  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 11:33:44,335 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 101712  - Execute sql: SELECT top 100 [Procedure], COUNT(*) AS RequestHit, SUM(duration) / 1000000  AS [Duration (s)], SUM(CPU) AS CPU, SUM(Reads) AS Reads, SUM(Writes) AS Writes, SUM(Error) as ErrorHits from (SELECT  CHARINDEX(' ', convert(nvarchar(200), a.TextData) + ' ', 6) as Pos, left(convert(nvarchar(200), a.TextData), CHARINDEX(' ', convert(nvarchar(200), a.TextData) + ' ', 6)) as [Procedure], a.Duration, a.CPU, a.Reads, a.Writes, a.Error FROM sys.fn_trace_gettable('E:\TraceLogs\FECredit\2017-03\\traceihrp_56.trc', 1) a WHERE a.EventClass in (10, 12)) aa where Pos > 9 group by [Procedure] order by [Duration (s)] desc  
2017-03-14 11:33:50,556 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 107933  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('E:\TraceLogs\FECredit\2017-03\\traceihrp_56.trc', 1) a  
2017-03-14 11:33:54,832 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 112208  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 11:33:54,833 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 112210  - Execute sql: SELECT top 100 [Procedure], COUNT(*) AS RequestHit, SUM(duration) / 1000000  AS [Duration (s)], SUM(CPU) AS CPU, SUM(Reads) AS Reads, SUM(Writes) AS Writes, SUM(Error) as ErrorHits from (SELECT  CHARINDEX(' ', convert(nvarchar(200), a.TextData) + ' ', 6) as Pos, left(convert(nvarchar(200), a.TextData), CHARINDEX(' ', convert(nvarchar(200), a.TextData) + ' ', 6)) as [Procedure], a.Duration, a.CPU, a.Reads, a.Writes, a.Error FROM sys.fn_trace_gettable('E:\TraceLogs\FECredit\2017-03\\traceihrp_56.trc', 10) a WHERE a.EventClass in (10, 12)) aa where Pos > 9 group by [Procedure] order by [Duration (s)] desc  
2017-03-14 11:36:27,985 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 265362  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 11:36:27,986 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 265363  - Execute sql: SELECT top 100 [Procedure], COUNT(*) AS RequestHit, SUM(duration) / 1000000  AS [Duration (s)], SUM(CPU) AS CPU, SUM(Reads) AS Reads, SUM(Writes) AS Writes, SUM(Error) as ErrorHits from (SELECT  CHARINDEX(' ', convert(nvarchar(200), a.TextData) + ' ', 6) as Pos, left(convert(nvarchar(200), a.TextData), CHARINDEX(' ', convert(nvarchar(200), a.TextData) + ' ', 6)) as [Procedure], a.Duration, a.CPU, a.Reads, a.Writes, a.Error FROM sys.fn_trace_gettable('E:\TraceLogs\FECredit\2017-03\\traceihrp_56.trc', 10) a WHERE a.EventClass in (10, 12)) aa where Pos > 9 group by [Procedure] order by [Duration (s)] desc  
2017-03-14 11:41:15,118 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 552495  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-14 11:45:45,532 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 822909  - Execute sql: SELECT top 100 a.TextData, a.HostName, a.ApplicationName, a.LoginName, a.ServerName, 
		a.EventClass, a.Error, a.DatabaseName, a.RowCounts, a.Duration / 1000000 as [Duration (s)], a.StartTime, 
		a.EndTime, a.Reads, a.Writes, a.CPU FROM sys.fn_trace_gettable('E:\TraceLogs\FECredit\2017-03\\traceihrp_56.trc', 10) a 
WHERE a.EventClass in (10, 12) 
	and a.ApplicationName = '.Net SqlClient Data Provider'
	and (a.Duration / 1000000) > 20
order by a.Duration desc  
2017-03-14 11:46:30,823 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 868200  - Execute sql: SELECT a.TextData, a.HostName, a.ApplicationName, a.LoginName, a.ServerName, 
		a.EventClass, a.Error, a.DatabaseName, a.RowCounts, a.Duration / 1000000 as [Duration (s)], a.StartTime, 
		a.EndTime, a.Reads, a.Writes, a.CPU FROM sys.fn_trace_gettable('E:\TraceLogs\FECredit\2017-03\\traceihrp_56.trc', 10) a 
WHERE a.EventClass in (10, 12) 
	and a.ApplicationName = '.Net SqlClient Data Provider'
	and (a.Duration / 1000000) > 20
order by a.Duration desc  
2017-03-14 11:46:38,491 ERROR FISSOFT\NgocLD Profiler.Form1 ExportCustom 875868  - Exception: You want to put a string longer than 32K to Cell A574. MS Excel only allows to put a string shorter than 32K to a Cell.  
2017-03-14 11:46:58,794 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 896171  - Execute sql: SELECT convert(nvarchar(4000), a.TextData) as Query, a.HostName, a.ApplicationName, a.LoginName, a.ServerName, 
		a.EventClass, a.Error, a.DatabaseName, a.RowCounts, a.Duration / 1000000 as [Duration (s)], a.StartTime, 
		a.EndTime, a.Reads, a.Writes, a.CPU FROM sys.fn_trace_gettable('E:\TraceLogs\FECredit\2017-03\\traceihrp_56.trc', 10) a 
WHERE a.EventClass in (10, 12) 
	and a.ApplicationName = '.Net SqlClient Data Provider'
	and (a.Duration / 1000000) > 20
order by a.Duration desc  
2017-03-21 10:08:55,914 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 685  - Open connection to SQL Server  
2017-03-21 10:08:56,077 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 848  - Open connection to SQL Server  
2017-03-21 10:08:56,077 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 848  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null and is_default = 0;  
2017-03-21 10:08:56,115 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 885  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-21 10:08:56,115 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 885  - Execute sql: SELECT DISTINCT REVERSE(SUBSTRING(REVERSE(path), CHARINDEX('\', REVERSE(path)), 256)) as [DirTrace] FROM sys.traces WHERE max_files is not null and is_default = 0  
2017-03-21 10:08:56,130 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 901  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-21 10:08:58,050 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 2820  - Open connection to SQL Server  
2017-03-21 10:08:58,050 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 2820  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null and is_default = 0;  
2017-03-21 10:08:58,065 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 2836  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-21 10:08:58,065 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 2836  - Execute sql: SELECT DISTINCT REVERSE(SUBSTRING(REVERSE(path), CHARINDEX('\', REVERSE(path)), 256)) as [DirTrace] FROM sys.traces WHERE max_files is not null and is_default = 0  
2017-03-21 10:09:47,411 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 52182  - Open connection to SQL Server  
2017-03-21 10:09:47,521 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 52292  - Open connection to SQL Server  
2017-03-21 10:09:47,521 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 52292  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null and is_default = 0;  
2017-03-21 10:09:47,521 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 52292  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-21 10:09:47,521 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 52292  - Execute sql: SELECT DISTINCT REVERSE(SUBSTRING(REVERSE(path), CHARINDEX('\', REVERSE(path)), 256)) as [DirTrace] FROM sys.traces WHERE max_files is not null and is_default = 0  
2017-03-21 10:10:38,889 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 103659  - Open connection to SQL Server  
2017-03-21 10:10:38,889 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 103659  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null and is_default = 0;  
2017-03-21 10:10:38,905 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 103675  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-21 10:10:38,905 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 103675  - Execute sql: SELECT DISTINCT REVERSE(SUBSTRING(REVERSE(path), CHARINDEX('\', REVERSE(path)), 256)) as [DirTrace] FROM sys.traces WHERE max_files is not null and is_default = 0  
2017-03-21 10:10:39,605 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess ExecuteSqlNoTran 104376  - Execute sql: declare @rc INT declare @TraceID INT declare @maxfilesize BIGINT = 300 declare @countfile INT = 30 declare @PathfileLog NVARCHAR(256) = N'D:\Logs\PVGas\Tracelog\traceihrp' exec @rc = sp_trace_create @TraceID output, @options = 2, @tracefile = @PathfileLog, @maxfilesize = @maxfilesize, @stoptime = NULL, @filecount = @countfile declare @on BIT = 1 exec sp_trace_setevent @TraceID, 12, 1, @on exec sp_trace_setevent @TraceID, 12, 9, @on exec sp_trace_setevent @TraceID, 12, 11, @on exec sp_trace_setevent @TraceID, 12, 6, @on exec sp_trace_setevent @TraceID, 12, 8, @on exec sp_trace_setevent @TraceID, 12, 10, @on exec sp_trace_setevent @TraceID, 12, 12, @on exec sp_trace_setevent @TraceID, 12, 13, @on exec sp_trace_setevent @TraceID, 12, 14, @on exec sp_trace_setevent @TraceID, 12, 15, @on exec sp_trace_setevent @TraceID, 12, 16, @on exec sp_trace_setevent @TraceID, 12, 17, @on exec sp_trace_setevent @TraceID, 12, 18, @on exec sp_trace_setevent @TraceID, 12, 31, @on exec sp_trace_setevent @TraceID, 12, 35, @on exec sp_trace_setevent @TraceID, 12, 48, @on exec sp_trace_setevent @TraceID, 12, 60, @on exec sp_trace_setevent @TraceID, 81, 12, @on exec sp_trace_setevent @TraceID, 81, 14, @on exec sp_trace_setevent @TraceID, 81, 21, @on exec sp_trace_setevent @TraceID, 81, 25, @on exec sp_trace_setevent @TraceID, 81, 26, @on exec sp_trace_setevent @TraceID, 81, 51, @on exec sp_trace_setevent @TraceID, 81, 60, @on exec sp_trace_setevent @TraceID, 81, 64, @on exec sp_trace_setevent @TraceID, 92, 3, @on exec sp_trace_setevent @TraceID, 92, 11, @on exec sp_trace_setevent @TraceID, 92, 8, @on exec sp_trace_setevent @TraceID, 92, 10, @on exec sp_trace_setevent @TraceID, 92, 12, @on exec sp_trace_setevent @TraceID, 92, 13, @on exec sp_trace_setevent @TraceID, 92, 14, @on exec sp_trace_setevent @TraceID, 92, 15, @on exec sp_trace_setevent @TraceID, 92, 25, @on exec sp_trace_setevent @TraceID, 92, 26, @on exec sp_trace_setevent @TraceID, 92, 35, @on exec sp_trace_setevent @TraceID, 92, 51, @on exec sp_trace_setevent @TraceID, 92, 60, @on exec sp_trace_setevent @TraceID, 92, 64, @on exec sp_trace_setevent @TraceID, 94, 3, @on exec sp_trace_setevent @TraceID, 94, 11, @on exec sp_trace_setevent @TraceID, 94, 8, @on exec sp_trace_setevent @TraceID, 94, 10, @on exec sp_trace_setevent @TraceID, 94, 12, @on exec sp_trace_setevent @TraceID, 94, 13, @on exec sp_trace_setevent @TraceID, 94, 14, @on exec sp_trace_setevent @TraceID, 94, 15, @on exec sp_trace_setevent @TraceID, 94, 25, @on exec sp_trace_setevent @TraceID, 94, 26, @on exec sp_trace_setevent @TraceID, 94, 35, @on exec sp_trace_setevent @TraceID, 94, 51, @on exec sp_trace_setevent @TraceID, 94, 60, @on exec sp_trace_setevent @TraceID, 94, 64, @on exec sp_trace_setevent @TraceID, 93, 3, @on exec sp_trace_setevent @TraceID, 93, 11, @on exec sp_trace_setevent @TraceID, 93, 8, @on exec sp_trace_setevent @TraceID, 93, 10, @on exec sp_trace_setevent @TraceID, 93, 12, @on exec sp_trace_setevent @TraceID, 93, 13, @on exec sp_trace_setevent @TraceID, 93, 14, @on exec sp_trace_setevent @TraceID, 93, 15, @on exec sp_trace_setevent @TraceID, 93, 25, @on exec sp_trace_setevent @TraceID, 93, 26, @on exec sp_trace_setevent @TraceID, 93, 35, @on exec sp_trace_setevent @TraceID, 93, 51, @on exec sp_trace_setevent @TraceID, 93, 60, @on exec sp_trace_setevent @TraceID, 93, 64, @on exec sp_trace_setevent @TraceID, 95, 3, @on exec sp_trace_setevent @TraceID, 95, 11, @on exec sp_trace_setevent @TraceID, 95, 8, @on exec sp_trace_setevent @TraceID, 95, 10, @on exec sp_trace_setevent @TraceID, 95, 12, @on exec sp_trace_setevent @TraceID, 95, 13, @on exec sp_trace_setevent @TraceID, 95, 14, @on exec sp_trace_setevent @TraceID, 95, 15, @on exec sp_trace_setevent @TraceID, 95, 25, @on exec sp_trace_setevent @TraceID, 95, 26, @on exec sp_trace_setevent @TraceID, 95, 35, @on exec sp_trace_setevent @TraceID, 95, 51, @on exec sp_trace_setevent @TraceID, 95, 60, @on exec sp_trace_setevent @TraceID, 95, 64, @on exec sp_trace_setevent @TraceID, 25, 1, @on exec sp_trace_setevent @TraceID, 25, 9, @on exec sp_trace_setevent @TraceID, 25, 10, @on exec sp_trace_setevent @TraceID, 25, 3, @on exec sp_trace_setevent @TraceID, 25, 8, @on exec sp_trace_setevent @TraceID, 25, 11, @on exec sp_trace_setevent @TraceID, 25, 12, @on exec sp_trace_setevent @TraceID, 25, 13, @on exec sp_trace_setevent @TraceID, 25, 14, @on exec sp_trace_setevent @TraceID, 25, 15, @on exec sp_trace_setevent @TraceID, 25, 26, @on exec sp_trace_setevent @TraceID, 25, 32, @on exec sp_trace_setevent @TraceID, 25, 35, @on exec sp_trace_setevent @TraceID, 25, 57, @on exec sp_trace_setevent @TraceID, 25, 60, @on exec sp_trace_setevent @TraceID, 25, 64, @on exec sp_trace_setevent @TraceID, 10, 1, @on exec sp_trace_setevent @TraceID, 10, 9, @on exec sp_trace_setevent @TraceID, 10, 2, @on exec sp_trace_setevent @TraceID, 10, 10, @on exec sp_trace_setevent @TraceID, 10, 3, @on exec sp_trace_setevent @TraceID, 10, 6, @on exec sp_trace_setevent @TraceID, 10, 8, @on exec sp_trace_setevent @TraceID, 10, 11, @on exec sp_trace_setevent @TraceID, 10, 12, @on exec sp_trace_setevent @TraceID, 10, 13, @on exec sp_trace_setevent @TraceID, 10, 14, @on exec sp_trace_setevent @TraceID, 10, 15, @on exec sp_trace_setevent @TraceID, 10, 16, @on exec sp_trace_setevent @TraceID, 10, 17, @on exec sp_trace_setevent @TraceID, 10, 18, @on exec sp_trace_setevent @TraceID, 10, 26, @on exec sp_trace_setevent @TraceID, 10, 31, @on exec sp_trace_setevent @TraceID, 10, 35, @on exec sp_trace_setevent @TraceID, 10, 48, @on exec sp_trace_setfilter @TraceID, 10, 0, 7, N'Microsoft SQL Server Management Studio - Transact-SQL IntelliSense' exec sp_trace_setfilter @TraceID, 10, 0, 7, N'SQL Trace Log iHRP' exec sp_trace_setfilter @TraceID, 1, 0, 7, N'exec sp_reset_connection' exec sp_trace_setstatus @TraceID, 1   
2017-03-21 10:10:39,605 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 104376  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null and is_default = 0;  
2017-03-21 10:10:42,045 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 106815  - Open connection to SQL Server  
2017-03-21 10:10:42,178 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 106949  - Open connection to SQL Server  
2017-03-21 10:10:42,194 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 106965  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null and is_default = 0;  
2017-03-21 10:10:42,210 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 106980  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-21 10:10:42,210 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 106980  - Execute sql: SELECT DISTINCT REVERSE(SUBSTRING(REVERSE(path), CHARINDEX('\', REVERSE(path)), 256)) as [DirTrace] FROM sys.traces WHERE max_files is not null and is_default = 0  
2017-03-21 10:10:42,210 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 106980  - Execute sql: EXEC master.sys.xp_dirtree 'D:\Logs\PVGas\Tracelog\',1,1  
2017-03-21 10:11:05,428 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 130198  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('D:\Logs\PVGas\Tracelog\\traceihrp_23.trc', 1) a  
2017-03-21 10:11:06,760 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 131531  - Open connection to SQL Server  
2017-03-21 10:11:17,690 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 142461  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-21 10:12:40,663 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 225433  - Open connection to SQL Server  
2017-03-21 10:12:40,779 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 225550  - Open connection to SQL Server  
2017-03-21 10:12:40,779 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 225550  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null and is_default = 0;  
2017-03-21 10:12:40,795 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 225565  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-21 10:12:40,795 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 225565  - Execute sql: SELECT DISTINCT REVERSE(SUBSTRING(REVERSE(path), CHARINDEX('\', REVERSE(path)), 256)) as [DirTrace] FROM sys.traces WHERE max_files is not null and is_default = 0  
2017-03-21 10:12:40,795 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 225565  - Execute sql: EXEC master.sys.xp_dirtree 'D:\Logs\PVGas\Tracelog\',1,1  
2017-03-21 10:27:14,646 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 1099417  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('D:\Logs\PVGas\Tracelog\\traceihrp_23.trc', 1) a  
2017-03-21 10:27:16,910 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 1101681  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('D:\Logs\PVGas\Tracelog\\traceihrp_23.trc', 1) a  
2017-03-21 10:27:28,099 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 1112870  - Execute sql: --22/02 --> 19/03
SELECT top 100 a.TextData, a.HostName, a.RowCounts, 
a.Duration / 1000000 as [Duration (s)], a.StartTime, a.EndTime, a.Reads, a.Writes, a.CPU 

FROM sys.fn_trace_gettable('D:\Logs\PVGas\Tracelog\\traceihrp_23.trc', 15) a 
WHERE a.EventClass in (10, 12) 
	and a.ApplicationName = '.Net SqlClient Data Provider'
order by a.Duration desc  
2017-03-21 10:33:05,120 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 1449890  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-21 10:41:01,196 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 1925966  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2017-03-21 10:41:01,196 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 1925966  - Execute sql: SELECT top 100 a.TextData, a.HostName, a.ApplicationName, a.LoginName, a.ServerName, a.EventClass, a.Error, a.DatabaseName, a.RowCounts, a.Duration / 1000 as [Duration (ms)], a.StartTime, a.EndTime, a.Reads, a.Writes, a.CPU FROM sys.fn_trace_gettable('D:\Logs\PVGas\Tracelog\\traceihrp_23.trc', 15) a WHERE a.EventClass in (10, 12) order by isnull(a.EndTime, a.StartTime) desc  
2017-03-21 10:47:21,290 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 2306060  - Execute sql: SELECT top 100 [Procedure], COUNT(*) AS RequestHit, SUM(duration) / 1000000  AS [Duration (s)], 
		SUM(CPU) AS CPU, SUM(Reads) AS Reads, SUM(Writes) AS Writes, SUM(Error) as ErrorHits 
		
from 
	(
		SELECT  CHARINDEX(' ', convert(nvarchar(200), a.TextData) + ' ', 6) as Pos, left(convert(nvarchar(200), a.TextData), CHARINDEX(' ', convert(nvarchar(200), a.TextData) + ' ', 6)) as [Procedure], a.Duration, a.CPU, a.Reads, a.Writes, a.Error 
		FROM sys.fn_trace_gettable('D:\Logs\PVGas\Tracelog\\traceihrp_23.trc', 15) a 
		WHERE a.EventClass in (10, 12)
			and ApplicationName = '.Net SqlClient Data Provider'
) aa where Pos > 9 
group by [Procedure] 
order by [Duration (s)] desc  
2017-03-21 11:10:50,525 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 3715295  - Open connection to SQL Server  
