2016-03-02 09:14:29,693 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 630  - Open connection to SQL Server  
2016-03-02 09:14:29,830 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 767  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2016-03-02 09:14:29,847 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 784  - Open connection to SQL Server  
2016-03-02 09:14:29,848 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 785  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2016-03-02 09:14:29,852 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 789  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null;  
2016-03-02 09:14:29,893 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 830  - Execute sql: SELECT DISTINCT REVERSE(SUBSTRING(REVERSE(path), CHARINDEX('\', REVERSE(path)), 256)) as [DirTrace] FROM sys.traces WHERE max_files is not null  
2016-03-02 09:14:29,896 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 833  - Execute sql: EXEC master.sys.xp_dirtree 'C:\Program Files\Microsoft SQL Server\MSSQL11.MSSQLSERVER\MSSQL\Log\',1,1  
2016-03-02 09:15:20,987 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 51924  - Open connection to SQL Server  
2016-03-02 09:15:21,023 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 51960  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2016-03-02 09:15:21,083 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 52020  - Open connection to SQL Server  
2016-03-02 09:15:21,087 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 52024  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2016-03-02 09:15:21,091 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 52028  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null;  
2016-03-02 09:15:21,103 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 52040  - Execute sql: SELECT DISTINCT REVERSE(SUBSTRING(REVERSE(path), CHARINDEX('\', REVERSE(path)), 256)) as [DirTrace] FROM sys.traces WHERE max_files is not null  
2016-03-02 09:15:21,106 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 52043  - Execute sql: EXEC master.sys.xp_dirtree 'C:\Program Files\Microsoft SQL Server\MSSQL10_50.SQL2K8\MSSQL\Log\',1,1  
2016-03-02 09:15:26,772 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 57709  - Execute sql: /*1. TOP 100 LAST QUERY*/				SELECT top 100 a.TextData, a.HostName, a.ApplicationName, a.LoginName, a.ServerName, a.EventClass, a.Error, a.DatabaseName, a.RowCounts, a.Duration / 1000 as [Duration (ms)], a.StartTime, a.EndTime, a.Reads, a.Writes, a.CPU FROM sys.fn_trace_gettable('C:\Program Files\Microsoft SQL Server\MSSQL10_50.SQL2K8\MSSQL\Log\\ihrp_log.trc', 1) a order by isnull(a.EndTime, a.StartTime) desc	  
2016-03-02 09:15:38,296 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 69233  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('C:\Program Files\Microsoft SQL Server\MSSQL10_50.SQL2K8\MSSQL\Log\\traceihrp.trc', 1) a  
2016-03-02 09:15:44,779 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 75716  - Execute sql: /*2. TOP 100 QUERY WORST PERFORMANCE*/	SELECT top 100 a.TextData, a.HostName, a.ApplicationName, a.LoginName, a.ServerName, a.EventClass, a.Error, a.DatabaseName, a.RowCounts, a.Duration / 1000 as [Duration (ms)], a.StartTime, a.EndTime, a.Reads, a.Writes, a.CPU FROM sys.fn_trace_gettable('C:\Program Files\Microsoft SQL Server\MSSQL10_50.SQL2K8\MSSQL\Log\\traceihrp.trc', 1) a order by a.Duration desc  
2016-03-02 09:18:02,713 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 213649  - Execute sql: /*2. TOP 100 QUERY WORST PERFORMANCE*/	SELECT top 100 a.TextData, a.HostName, a.ApplicationName, a.LoginName, a.ServerName, a.EventClass, a.Error, a.DatabaseName, a.RowCounts, a.Duration / 1000000 as [Duration (s)], a.StartTime, a.EndTime, a.Reads, a.Writes, a.CPU FROM sys.fn_trace_gettable('C:\Program Files\Microsoft SQL Server\MSSQL10_50.SQL2K8\MSSQL\Log\\traceihrp.trc', 1) a order by a.Duration desc  
2016-03-02 09:19:26,739 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 410  - Open connection to SQL Server  
2016-03-02 09:19:26,807 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 478  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2016-03-02 09:19:26,815 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckConnectSQL 486  - Open connection to SQL Server  
2016-03-02 09:19:26,816 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess CheckUserIsSysAdmin 487  - Execute sql: IF IS_SRVROLEMEMBER ('sysadmin') = 1 select 'IsSysAdmin' as IsSysAdmin  
2016-03-02 09:19:26,821 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 492  - Execute sql: select	a.id, case a.status when '1' then 'Running' when '0' then 'Stop' end as status, a.max_size, a.max_files, convert(varchar, a.start_time, 120) as start, convert(varchar, a.last_event_time, 120) as last, a.event_count as [count],a.path as [path_server] from sys.traces a where a.max_files is not null;  
2016-03-02 09:19:26,843 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 514  - Execute sql: SELECT DISTINCT REVERSE(SUBSTRING(REVERSE(path), CHARINDEX('\', REVERSE(path)), 256)) as [DirTrace] FROM sys.traces WHERE max_files is not null  
2016-03-02 09:19:26,847 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 518  - Execute sql: EXEC master.sys.xp_dirtree 'C:\Program Files\Microsoft SQL Server\MSSQL10_50.SQL2K8\MSSQL\Log\',1,1  
2016-03-02 09:19:30,713 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 4383  - Execute sql: /*3. TOP 100 PROCEDURE*/				select top 100 [Procedure], COUNT(*) AS RequestHit, SUM(duration) / 1000000  AS [Duration (s)], SUM(CPU) AS CPU, SUM(Reads) AS Reads, SUM(Writes) AS Writes, SUM(Error) as ErrorHits from(SELECT  CHARINDEX(' ', convert(nvarchar, a.TextData), 0) as Pos, left(convert(nvarchar, a.TextData), CHARINDEX(' ', a.TextData, 0)) as [Procedure], a.Duration, a.CPU, a.Reads, a.Writes, a.Error FROM sys.fn_trace_gettable('C:\Program Files\Microsoft SQL Server\MSSQL10_50.SQL2K8\MSSQL\Log\\ihrp_log.trc', 1) a ) aa where Pos > 9 group by [Procedure] order by RequestHit desc  
2016-03-02 09:19:38,877 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataRowSql 12547  - Execute sql: SELECT left(convert(varchar, min(a.StartTime), 120), 16) as StartTime, left(convert(varchar, max(a.EndTime), 120), 16) as EndTime, count(a.StartTime) as [RowCount] FROM sys.fn_trace_gettable('C:\Program Files\Microsoft SQL Server\MSSQL10_50.SQL2K8\MSSQL\Log\\traceihrp.trc', 1) a  
2016-03-02 09:19:49,127 INFO FISSOFT\NgocLD Profiler.Helpers.clsDataAccess GetDataTableSql 22797  - Execute sql: /*4. TOP 100 ROWCOUNT*/					SELECT top 100 a.TextData, a.HostName, a.ApplicationName, a.LoginName, a.ServerName, a.EventClass, a.Error, a.DatabaseName, a.RowCounts, a.Duration / 1000 as [Duration (ms)], a.StartTime, a.EndTime, a.Reads, a.Writes, a.CPU FROM sys.fn_trace_gettable('C:\Program Files\Microsoft SQL Server\MSSQL10_50.SQL2K8\MSSQL\Log\\traceihrp.trc', 1) a order by a.RowCounts desc  
